function sampleImage(e){var i=["sample/sample1.png","sample/sample0.jpg"];i[e];this.imageViewer.addImages(i),setTimeout(function(){this.engine.addShape(new AbShapePolygon({x:133.02988505747126,y:116.72720306513409,width:167.59157088122603,height:116.0750957854406,points:[{x:11.08582375478926,y:43.6911877394636},{x:92.59923371647508,y:0},{x:167.59157088122603,y:64.55862068965516},{x:95.20766283524904,y:116.0750957854406},{x:0,y:93.90344827586208},{x:18.25900383141763,y:67.16704980842911},{x:84.77394636015325,y:87.3823754789272},{x:115.42298850574713,y:62.6022988505747},{x:86.07816091954021,y:31.30114942528735},{x:41.082758620689646,y:54.77701149425286}]})),this.engine.addShape(new AbShapeRectangle({x:173.28966061562747,y:422.8492501973165,width:193.43962115232833,height:80.59984214680344})),this.engine.createShape("memopad",{x:77.91318074191003,y:298.21941594317286,width:133,height:86,style:{color:"#99CFFF"},text:"테스트입니다.\n이 얼간이야!!"},function(e){e.prepare(),this.engine.addShape(e),this.engine.render();var i=this.engine.currentPage;this.renderThumbnail(i)}.bind(this))}.bind(this.imageViewer),500)}$(function(){AbViewController.initialize().then(function(){}).catch(function(e){console.log("[이미지 뷰어 초기화 오류]"),console.log(e),AbMsgBox.errorHtml("엔진 준비 중 오류가 발생했습니다<br/>페이지를 다시 로드해주세요")})});var AbViewController={SERVER_ACCESS:!0,imageViewer:null,onPreInitailize:null,onInitailize:null,initialize:function(){return this.initServerUrls(),this.initEnvironment(),AbCommon.isFunction(this.onPreInitailize)&&this.onPreInitailize(),this.loadConfig().then(function(e){return this.prepare(e)}.bind(this)).then(function(e){return this.initImageViewer(e).then(function(){AbCommon.isFunction(this.onInitailize)&&this.onInitailize(this.imageViewer)}.bind(this))}.bind(this))},initServerUrls:function(){var e="",i=AbViewController.SERVER_ACCESS?"resources/":"";AbVendor.executePath=e+i+AbVendor.executePath,AbImageLoader.executePath=e+i+AbImageLoader.executePath,AbImageLoader.URLS.CONVERTER="api/doc",AbImageViewer.prototype.URLS.CONFIG=e+"api/config",AbImageViewer.prototype.URLS.PERMISSION=e+"api/permission",AbImageViewer.prototype.URLS.OPEN=e+"api/images",AbImageViewer.prototype.URLS.SAVE.ALLOC=e+"api/alloc",AbImageViewer.prototype.URLS.SAVE.MODIFY=e+"api/modify-prepare",AbImageViewer.prototype.URLS.SAVE.IMAGE=e+"api/save-image",AbImageViewer.prototype.URLS.SAVE.REMOVE=e+"api/remove",AbImageViewer.prototype.URLS.SAVE.COMPLETED=e+"api/save-completed",AbImageViewer.prototype.URLS.PRINT.ALLOC=e+"api/print-support/alloc",AbImageViewer.prototype.URLS.PRINT.IMAGE=e+"api/print-support/save",AbImageViewer.prototype.URLS.PRINT.REMOVE=e+"api/print-support/remove",AbImageViewer.prototype.URLS.PRINT.DOWNLOAD=e+"print-support/img",iAbViewer.URLS.FOLDER=e+iAbViewer.URLS.FOLDER,iAbViewer.URLS.FILE=e+iAbViewer.URLS.FILE,iAbViewer.URLS.FILE_EX=e+iAbViewer.URLS.FILE_EX},initEnvironment:function(){AbCommon.ieVersion()!=-1&&(AbCommon.ENABLE_WEB_WORKER=!0),AbImageViewer.prototype.PARALLELS=3,AbImageViewer.prototype.SPLIT_DATA_SIZE=307200},loadConfig:function(){var e=AbLoading.get({text:"환경설정을 불러오는 중입니다..."});e.show();var i=$("#param-a").val(),t=this;return new Promise(function(r,a){AbViewController.SERVER_ACCESS?AbCommon.ajax({caller:t,title:"서버 옵션 로드",url:AbImageViewer.prototype.URLS.CONFIG,data:{a:i},success:function(i){e.hide(),r(i)},error:function(i){e.hide(),a(i)}}):(e.hide(),r({viewer:{mode:"edit",waterMark:{image:"img/watermark.png"},image:{save:"all",storage:{type:"db",path:"C:\\Users\\Administrator\\Desktop\\AB_DOC"},"local-save-limit":0},toolbar:{layout:["all"]},shape:{save:"all",addUI:"toolbar",selection:{style:"box",target:["rectangle","ellipse","pen","polygon","masking.rectangle","masking.ellipse"],lineDrawStyle:"path"},"local-save-limit":0}},auth:{config:{enabled:!1,account:{source:"cgi",field:"ab_usr_id",type:"id"}},permission:null}}))})},prepare:function(e){var i=null,t={level:-99,permissions:[],value:null},r=e&&e.viewer&&e.viewer.toolbar?e.viewer.toolbar.layout:"all";if("all"!==r&&this.setLayout(r),e&&e.auth&&e.auth.config.enabled===!0){var a="local-storage"===e.auth.config.account.source,n="session-storage"===e.auth.config.account.source;if(a||n){var o=null;n?o=sessionStorage.getItem(e.auth.config.account.field):a&&(o=localStorage.getItem(e.auth.config.account.field)),o?i=this.loadPermissions(o).then(function(i){return e.auth.permission=i,e.auth.permission.map=this.permissionMap(e.auth.permission),this.setLayoutByPermission(e.auth.permission),e}.bind(this)):(t.map={},e.auth.permission=t,this.setLayoutByPermission(e.auth.permission))}else t.map=this.permissionMap(e.auth.permission),e.auth.permission=t}return i||(i=Promise.resolve(e)),i},permissionMap:function(e){var i=e&&e.permissions?e.permissions.length:0;if(!i)return null;for(var t={},r=0;r<i;r++){var a=e.permissions[r];t[a.itm]="Y"===a.useYn}return t},setLayout:function(e){for(var i=$("[ab-layout]"),t=i.length,r=0;r<t;r++){for(var a=i.get(r),n=$(a),o=n.attr("ab-layout"),s=!1,l=o.trim().split(/\s*,\s*/g),p=l.length,m=0;m<p;m++){var u=l[m];if($.inArray(u,e)>=0){s=!0;break}}s||n.detach()}},setLayoutByPermission:function(e){var i=e?e.level:-1,t=e&&e.map?e.map:{};if(0!=i)for(var r=$("[ab-perm],[tb-topic]"),a=r.length,n=0;n<a;n++){var o=r.get(n),s=$(o),l=s.attr("tb-topic"),p=s.attr("ab-perm"),m=!1;if(l)m=t[l]===!0;else if(p)for(var u=p.trim().split(/\s*,\s*/g),h=u.length,g=0;g<h;g++){var c=u[g];if(t[c]===!0){m=!0;break}}m||s.detach()}},loadPermissions:function(e){if(!e)return Promise.resolve();var i=AbLoading.get({text:"권한 정보를 불러오는 중입니다..."});i.show();var t=this;return new Promise(function(r,a){AbViewController.SERVER_ACCESS?AbCommon.ajax({caller:t,title:"권한 정보 로드",url:AbImageViewer.prototype.URLS.PERMISSION,data:{value:e},success:function(e){i.hide(),r(e)},error:function(e){i.hide(),a(e)}}):(i.hide(),r(null))})},initImageViewer:function(e){var i=2,t=new AbImageViewer({margin:{left:i,top:i,right:i,bottom:i},config:e?e.viewer:null,permission:{auth:e?e.auth:null,check:function(e){var i=this.auth?this.auth.config:null;if(i.enabled!==!0)return!0;var t=this.auth?this.auth.permission:null,r=t?t.level:-1,a=t&&t.map?t.map:{};return 0===r||a.hasOwnProperty(e)&&a[e]===!0}}});"undefined"!=typeof iAbViewer&&iAbViewer.regist(t),this.imageViewer=t;var r=e&&e.viewer&&e.viewer.waterMark&&e.viewer.waterMark.image?$.trim(e.viewer.waterMark.image):null,a=null;return a=r?t.waterMark.image(r):Promise.resolve(),a.then(function(){return t.install().then(function(){return this.loadedImageViewer()}.bind(this))}.bind(this))},loadedImageViewer:function(){AbViewController.SERVER_ACCESS&&AbNoop.exec();var e=$("#param-id").val();return e?this.imageViewer.openImages(e):Promise.resolve()}};